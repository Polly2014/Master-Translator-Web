# ğŸ“„ æ–‡ä»¶å’Œ Chunk é¢„è§ˆåŠŸèƒ½æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

**ç‰ˆæœ¬**: 2.0  
**æ–°å¢æ—¥æœŸ**: 2025-01-XX  
**åŠŸèƒ½**: ä¸ºä¸Šä¼ æ–‡ä»¶å’Œåˆ†å—ï¼ˆChunksï¼‰æ·»åŠ æµè§ˆå™¨å†…é¢„è§ˆåŠŸèƒ½

### æ–°å¢åŠŸèƒ½

é™¤äº†åŸæœ‰çš„**ç¿»è¯‘ç»“æœé¢„è§ˆ**ï¼Œç°åœ¨è¿˜æ”¯æŒï¼š

1. **ğŸ“„ ä¸Šä¼ æ–‡ä»¶é¢„è§ˆ** - æŸ¥çœ‹åŸå§‹ä¸Šä¼ çš„ Markdown æ–‡ä»¶
2. **âœ‚ï¸ Chunk å—é¢„è§ˆ** - ç‚¹å‡»ä»»æ„ chunk æŸ¥çœ‹å…¶å†…å®¹
3. **âœ… ç¿»è¯‘ç»“æœé¢„è§ˆ** - æŸ¥çœ‹æœ€ç»ˆçš„ç¿»è¯‘ç»“æœï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰

## ğŸ¨ ä¸‰ç§é¢„è§ˆæ¨¡å¼

### 1. ä¸Šä¼ æ–‡ä»¶é¢„è§ˆ (Source File Preview)

**è§¦å‘æ–¹å¼**: ç‚¹å‡»æ–‡ä»¶ä¿¡æ¯ä¸‹æ–¹çš„ "ğŸ‘ï¸ Preview Uploaded File" æŒ‰é’®

**æ˜¾ç¤ºå†…å®¹**:
- åŸå§‹ä¸Šä¼ çš„è‹±æ–‡ Markdown æ–‡ä»¶
- å®Œæ•´çš„åŸå§‹æ ¼å¼
- åŒè§†å›¾æ”¯æŒï¼ˆRaw Text / Renderedï¼‰

**ä½¿ç”¨åœºæ™¯**:
- ç¡®è®¤ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ­£ç¡®
- åœ¨ç¿»è¯‘å‰å¿«é€Ÿæ£€æŸ¥æºæ–‡ä»¶å†…å®¹
- å¯¹æ¯”æºæ–‡ä»¶å’Œç¿»è¯‘ç»“æœ

**ç•Œé¢ä½ç½®**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¤ Upload File                     â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Filename: book.md            â”‚ â”‚
â”‚  â”‚  Size: 150 KB                 â”‚ â”‚
â”‚  â”‚  Characters: 125,430          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ‘ï¸  Preview Uploaded File   â”‚ â”‚  â† æ–°å¢æŒ‰é’®
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Chunk å—é¢„è§ˆ (Chunk Preview)

**è§¦å‘æ–¹å¼**: ç›´æ¥ç‚¹å‡»ä»»æ„ Chunk å¡ç‰‡

**æ˜¾ç¤ºå†…å®¹**:
- è¯¥ Chunk åŒ…å«çš„å®Œæ•´å†…å®¹
- ç« èŠ‚ä¿¡æ¯
- Prologue/Epilogue æ ‡è®°ï¼ˆå¦‚æœæœ‰ï¼‰
- åŒè§†å›¾æ”¯æŒ

**ä½¿ç”¨åœºæ™¯**:
- æŸ¥çœ‹åˆ†å—ç­–ç•¥æ˜¯å¦åˆç†
- æ£€æŸ¥æŸä¸ªç‰¹å®š Chunk çš„å†…å®¹
- éªŒè¯ç« èŠ‚è¾¹ç•Œæ˜¯å¦æ­£ç¡®

**ç•Œé¢äº¤äº’**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ‚ï¸  Chunk Preview                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Chunk 1          8,450 charsâ”‚   â”‚  â† ç‚¹å‡»å³å¯é¢„è§ˆ
â”‚  â”‚ Chapter 1, Chapter 2        â”‚   â”‚
â”‚  â”‚ [Prologue]                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Chunk 2         12,300 charsâ”‚   â”‚  â† hover æ˜¾ç¤ºé«˜äº®
â”‚  â”‚ Chapter 3, Chapter 4        â”‚   â”‚     cursor: pointer
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§†è§‰åé¦ˆ**:
- **é»˜è®¤**: ç°è‰²è¾¹æ¡†
- **Hover**: è“è‰²è¾¹æ¡† + èƒŒæ™¯åŠ æ·±
- **æç¤º**: "ğŸ‘ï¸ Click to preview" æ˜¾ç¤ºåœ¨å³ä¸Šè§’

---

### 3. ç¿»è¯‘ç»“æœé¢„è§ˆ (Translation Preview)

**è§¦å‘æ–¹å¼**: ç‚¹å‡»ç¿»è¯‘å®Œæˆåçš„ "ğŸ‘ï¸ Preview Translation" æŒ‰é’®

**æ˜¾ç¤ºå†…å®¹**:
- å®Œæ•´çš„ç¿»è¯‘ç»“æœ
- ç›®æ ‡è¯­è¨€çš„æ ¼å¼åŒ–å†…å®¹
- åŒè§†å›¾æ”¯æŒ
- ç»Ÿè®¡ä¿¡æ¯
- ä¸‹è½½æŒ‰é’®

**ä½¿ç”¨åœºæ™¯**:
- ç¿»è¯‘å®Œæˆåå¿«é€ŸæŸ¥çœ‹ç»“æœ
- éªŒè¯ç¿»è¯‘è´¨é‡
- æ— éœ€ä¸‹è½½å³å¯æ ¡å¯¹

---

## ğŸ–¼ï¸ é¢„è§ˆæ¨¡æ€æ¡†

### ç»Ÿä¸€çš„é¢„è§ˆçª—å£

æ‰€æœ‰ä¸‰ç§é¢„è§ˆä½¿ç”¨**åŒä¸€ä¸ªæ¨¡æ€æ¡†**ï¼Œä½†æ˜¾ç¤ºä¸åŒçš„æ ‡é¢˜å’Œå›¾æ ‡ï¼š

| é¢„è§ˆç±»å‹ | æ ‡é¢˜ | å›¾æ ‡ | ä¸‹è½½æŒ‰é’® |
|---------|------|------|---------|
| ä¸Šä¼ æ–‡ä»¶ | "Uploaded File Preview" | ğŸ“„ | âŒ éšè— |
| Chunk å— | "Chunk {N} Preview" | âœ‚ï¸ | âŒ éšè— |
| ç¿»è¯‘ç»“æœ | "Translation Preview" | âœ… | âœ… æ˜¾ç¤º |

### æ¨¡æ€æ¡†ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  {Icon} {Title}         [Raw Text] [Rendered]           âŒ  â”‚  â† åŠ¨æ€æ ‡é¢˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  # Chapter 1: Introduction                                 â”‚
â”‚                                                            â”‚
â”‚  This is the content with proper formatting...             â”‚
â”‚                                                            â”‚
â”‚  ## Section 1.1                                            â”‚
â”‚                                                            â”‚
â”‚                        (å¯æ»šåŠ¨å†…å®¹åŒºåŸŸ)                       â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š 1,234 words â€¢ 5,678 characters                         â”‚
â”‚                                          [ğŸ“¥ Download]     â”‚  â† ä»…ç¿»è¯‘ç»“æœæ˜¾ç¤º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### å‰ç«¯ (HTML + JavaScript)

#### 1. HTML æ–°å¢å…ƒç´ 

**ä¸Šä¼ æ–‡ä»¶é¢„è§ˆæŒ‰é’®** (`templates/index.html` Line ~220):
```html
<button id="previewSourceBtn" 
    class="w-full mt-3 bg-gradient-to-r from-purple-600 to-pink-500 
    hover:from-purple-700 hover:to-pink-600 text-white font-bold 
    py-2 rounded-lg transition-all">
    <span class="text-lg">ğŸ‘ï¸</span> Preview Uploaded File
</button>
```

**åŠ¨æ€æ¨¡æ€æ¡†æ ‡é¢˜** (`templates/index.html` Line ~470):
```html
<h2 class="text-2xl font-bold flex items-center gap-2">
    <span id="previewIcon">ğŸ‘ï¸</span>
    <span id="previewTitle">Preview</span>
</h2>
```

**Chunk å¡ç‰‡æ ·å¼** (`static/js/app.js` Line ~255):
```javascript
chunkEl.className = 'bg-slate-700/50 rounded-lg p-3 border border-slate-600 
    cursor-pointer hover:border-blue-500 hover:bg-slate-700 transition-all';
```

#### 2. JavaScript æ–°å¢å‡½æ•°

**`previewSource()`** - é¢„è§ˆä¸Šä¼ æ–‡ä»¶:
```javascript
async function previewSource() {
    // è®¾ç½®æ ‡é¢˜å’Œå›¾æ ‡
    titleEl.textContent = 'Uploaded File Preview';
    iconEl.textContent = 'ğŸ“„';
    
    // è·å–æºæ–‡ä»¶å†…å®¹
    const response = await fetch(`/api/preview-source/${currentTaskId}`);
    
    // æ˜¾ç¤ºå†…å®¹
    // éšè—ä¸‹è½½æŒ‰é’®
}
```

**`previewChunk(chunkId)`** - é¢„è§ˆç‰¹å®š Chunk:
```javascript
async function previewChunk(chunkId) {
    // è®¾ç½®æ ‡é¢˜å’Œå›¾æ ‡
    titleEl.textContent = `Chunk ${chunkId} Preview`;
    iconEl.textContent = 'âœ‚ï¸';
    
    // è·å– Chunk å†…å®¹
    const response = await fetch(`/api/preview-chunk/${currentTaskId}/${chunkId}`);
    
    // æ˜¾ç¤ºå†…å®¹å’Œç« èŠ‚ä¿¡æ¯
    // éšè—ä¸‹è½½æŒ‰é’®
}
```

**`loadPreviewContent()` ä¿®æ”¹** - æ”¯æŒä¸åŒé¢„è§ˆç±»å‹:
```javascript
async function loadPreviewContent(taskId, previewType = 'translation') {
    // previewType: 'translation' | 'source' | 'chunk'
    
    // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒçš„æ ‡é¢˜å’Œå›¾æ ‡
    const titles = {
        'translation': { title: 'Translation Preview', icon: 'âœ…' },
        'source': { title: 'Uploaded File Preview', icon: 'ğŸ“„' },
        'chunk': { title: 'Chunk Preview', icon: 'âœ‚ï¸' }
    };
    
    // æ§åˆ¶ä¸‹è½½æŒ‰é’®æ˜¾ç¤º
    if (previewType === 'translation') {
        downloadBtn.classList.remove('hidden');
    } else {
        downloadBtn.classList.add('hidden');
    }
}
```

**`displayChunks()` ä¿®æ”¹** - æ·»åŠ ç‚¹å‡»äº‹ä»¶:
```javascript
chunks.forEach(chunk => {
    const chunkEl = document.createElement('div');
    
    // æ·»åŠ ç‚¹å‡»æç¤º
    chunkEl.innerHTML = `
        <div class="flex items-center gap-2">
            <span class="text-xs text-gray-500">ğŸ‘ï¸ Click to preview</span>
        </div>
    `;
    
    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
    chunkEl.addEventListener('click', () => {
        previewChunk(chunk.id);
    });
});
```

---

### åç«¯ (Flask API)

#### 1. æ–°å¢ API ç«¯ç‚¹

**`/api/preview-source/<task_id>`** - é¢„è§ˆä¸Šä¼ æ–‡ä»¶:
```python
@app.route('/api/preview-source/<task_id>')
def preview_source(task_id):
    """é¢„è§ˆä¸Šä¼ çš„æºæ–‡ä»¶å†…å®¹"""
    if task_id not in tasks:
        return jsonify({'error': 'ä»»åŠ¡ä¸å­˜åœ¨'}), 404
    
    task = tasks[task_id]
    
    if not task.source_content:
        return jsonify({'error': 'æºæ–‡ä»¶å†…å®¹ä¸å¯ç”¨'}), 400
    
    return jsonify({
        'success': True,
        'content': task.source_content,
        'filename': task.filename,
        'language': 'English (source)'
    })
```

**`/api/preview-chunk/<task_id>/<int:chunk_id>`** - é¢„è§ˆç‰¹å®š Chunk:
```python
@app.route('/api/preview-chunk/<task_id>/<int:chunk_id>')
def preview_chunk(task_id, chunk_id):
    """é¢„è§ˆç‰¹å®š chunk çš„å†…å®¹"""
    if task_id not in tasks:
        return jsonify({'error': 'ä»»åŠ¡ä¸å­˜åœ¨'}), 404
    
    task = tasks[task_id]
    
    if not task.chunks_info:
        return jsonify({'error': 'Chunk ä¿¡æ¯ä¸å¯ç”¨ï¼Œè¯·å…ˆåˆ†ææ–‡ä»¶'}), 400
    
    # æŸ¥æ‰¾å¯¹åº”çš„ chunk
    chunk_data = None
    for chunk in task.chunks_info:
        if chunk['id'] == chunk_id:
            chunk_data = chunk
            break
    
    if not chunk_data:
        return jsonify({'error': f'Chunk {chunk_id} ä¸å­˜åœ¨'}), 404
    
    # è·å– chunk çš„å®Œæ•´å†…å®¹
    content = chunk_data.get('content', '')
    
    return jsonify({
        'success': True,
        'content': content,
        'chunk_id': chunk_id,
        'chapters': chunk_data.get('chapters', []),
        'size': chunk_data.get('size', 0),
        'has_prologue': chunk_data.get('has_prologue', False),
        'has_epilogue': chunk_data.get('has_epilogue', False)
    })
```

#### 2. æ•°æ®ç»“æ„

**TranslationTask ç±»** (`app.py` Line ~143):
```python
class TranslationTask:
    def __init__(self, task_id, filename, language):
        self.source_content = ""      # ä¿å­˜ä¸Šä¼ æ–‡ä»¶çš„å®Œæ•´å†…å®¹
        self.chunks_info = []          # ä¿å­˜æ‰€æœ‰ chunk çš„è¯¦ç»†ä¿¡æ¯
```

**plan_chunks å‡½æ•°** (`app.py` Line ~216):
```python
def plan_chunks(chapters, content):
    """è§„åˆ’åˆ†å— - æ¯ä¸ª chunk åŒ…å«å®Œæ•´å†…å®¹"""
    chunks = []
    
    for chunk in chunks:
        chunks.append({
            'id': chunk_id,
            'chapters': ['Chapter 1', 'Chapter 2'],
            'content': full_chunk_content,  # â† ä¿å­˜å®Œæ•´å†…å®¹
            'size': len(full_chunk_content),
            'has_prologue': False,
            'has_epilogue': False
        })
    
    return chunks
```

---

## ğŸ“Š å®Œæ•´åŠŸèƒ½æµç¨‹

### æµç¨‹ 1: é¢„è§ˆä¸Šä¼ æ–‡ä»¶

```
ç”¨æˆ·ä¸Šä¼  book.md
    â†“
æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
    â†“
ç”¨æˆ·ç‚¹å‡» "Preview Uploaded File" æŒ‰é’®
    â†“
JavaScript è°ƒç”¨ previewSource()
    â†“
è°ƒç”¨ GET /api/preview-source/{task_id}
    â†“
Flask è¿”å› task.source_content
    â†“
åœ¨é¢„è§ˆæ¨¡æ€æ¡†ä¸­æ˜¾ç¤º
    â”œâ”€ æ ‡é¢˜: "ğŸ“„ Uploaded File Preview"
    â”œâ”€ Raw Text: åŸå§‹ Markdown
    â”œâ”€ Rendered: æ ¼å¼åŒ–çš„ HTML
    â””â”€ ç»Ÿè®¡: å­—æ•°å’Œå­—ç¬¦æ•°
```

### æµç¨‹ 2: é¢„è§ˆ Chunk

```
ç”¨æˆ·ç‚¹å‡» "Analyze Chunks"
    â†“
ç³»ç»Ÿåˆ†ææ–‡ä»¶ï¼Œç”Ÿæˆ chunks_info
    â†“
æ˜¾ç¤º Chunk åˆ—è¡¨ï¼ˆå¯ç‚¹å‡»ï¼‰
    â†“
ç”¨æˆ·ç‚¹å‡» Chunk 2 å¡ç‰‡
    â†“
JavaScript è°ƒç”¨ previewChunk(2)
    â†“
è°ƒç”¨ GET /api/preview-chunk/{task_id}/2
    â†“
Flask ä» chunk_data['content'] è·å–å†…å®¹
    â†“
åœ¨é¢„è§ˆæ¨¡æ€æ¡†ä¸­æ˜¾ç¤º
    â”œâ”€ æ ‡é¢˜: "âœ‚ï¸ Chunk 2 Preview"
    â”œâ”€ å†…å®¹: Chunk 2 çš„å®Œæ•´ Markdown
    â”œâ”€ ç« èŠ‚: "Chapter 3, Chapter 4"
    â””â”€ ç»Ÿè®¡: "1,234 words â€¢ 5,678 characters â€¢ Chapter 3, Chapter 4"
```

### æµç¨‹ 3: é¢„è§ˆç¿»è¯‘ç»“æœ

```
ç¿»è¯‘å®Œæˆï¼ˆ100%ï¼‰
    â†“
æ˜¾ç¤ºä¸‹è½½é¢æ¿å’Œé¢„è§ˆæŒ‰é’®
    â†“
ç”¨æˆ·ç‚¹å‡» "Preview Translation"
    â†“
JavaScript è°ƒç”¨ loadPreviewContent(taskId, 'translation')
    â†“
è°ƒç”¨ GET /api/preview/{task_id}
    â†“
Flask è¯»å–ç¿»è¯‘ç»“æœæ–‡ä»¶
    â†“
åœ¨é¢„è§ˆæ¨¡æ€æ¡†ä¸­æ˜¾ç¤º
    â”œâ”€ æ ‡é¢˜: "âœ… Translation Preview"
    â”œâ”€ å†…å®¹: ç¿»è¯‘åçš„å†…å®¹
    â”œâ”€ ç»Ÿè®¡: å­—æ•°å’Œå­—ç¬¦æ•°
    â””â”€ ä¸‹è½½æŒ‰é’®: æ˜¾ç¤º
```

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶

```
åœºæ™¯: ç”¨æˆ·ä¸ç¡®å®šä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æ­£ç¡®

æ­¥éª¤:
1. ä¸Šä¼  Mustafa_Book_Demo.md
2. æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯: âœ… 1,037 words
3. ç‚¹å‡» "Preview Uploaded File"
4. åœ¨é¢„è§ˆçª—å£ä¸­ç¡®è®¤å†…å®¹
5. åˆ‡æ¢åˆ° "Raw Text" æŸ¥çœ‹åŸå§‹æ ¼å¼
6. ç¡®è®¤æ— è¯¯åï¼Œå…³é—­é¢„è§ˆ
7. ç»§ç»­åˆ†æå’Œç¿»è¯‘
```

### ç¤ºä¾‹ 2: æ£€æŸ¥åˆ†å—ç­–ç•¥

```
åœºæ™¯: ç”¨æˆ·æƒ³çœ‹çœ‹ç³»ç»Ÿå¦‚ä½•åˆ†å‰²å¤§æ–‡ä»¶

æ­¥éª¤:
1. ä¸Šä¼  å®Œæ•´ä¹¦ç± (150K words)
2. ç‚¹å‡» "Analyze Chunks"
3. ç³»ç»Ÿæ˜¾ç¤ºåˆ†æˆ 6 ä¸ª chunks
4. ç‚¹å‡» Chunk 1 æŸ¥çœ‹å†…å®¹
   â†’ çœ‹åˆ°: Prologue + Chapter 1-3
5. ç‚¹å‡» Chunk 6 æŸ¥çœ‹å†…å®¹
   â†’ çœ‹åˆ°: Chapter 18-20 + Epilogue
6. ç¡®è®¤åˆ†å—åˆç†
7. å¼€å§‹ç¿»è¯‘
```

### ç¤ºä¾‹ 3: å¯¹æ¯”æºæ–‡ä»¶å’Œç¿»è¯‘ç»“æœ

```
åœºæ™¯: ç¿»è¯‘å®Œæˆåï¼Œæƒ³å¯¹æ¯”åŸæ–‡å’Œè¯‘æ–‡

æ­¥éª¤:
1. ç¿»è¯‘å®Œæˆ
2. ç‚¹å‡» "Preview Translation" æŸ¥çœ‹è¯‘æ–‡
   â†’ æŸ¥çœ‹æ—¥è¯­ç¿»è¯‘çš„ç¬¬ä¸€ç« 
3. å…³é—­é¢„è§ˆ
4. ç‚¹å‡» "Preview Uploaded File" æŸ¥çœ‹åŸæ–‡
   â†’ å¯¹æ¯”è‹±æ–‡åŸæ–‡çš„ç¬¬ä¸€ç« 
5. åˆ‡æ¢è§†å›¾éªŒè¯æ ¼å¼ä¿æŒä¸€è‡´
6. ç¡®è®¤ç¿»è¯‘è´¨é‡æ»¡æ„
7. ä¸‹è½½ç¿»è¯‘ç»“æœ
```

---

## ğŸ’¡ è®¾è®¡äº®ç‚¹

### 1. ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ

- **ç›¸åŒçš„æ¨¡æ€æ¡†**: ä¸‰ç§é¢„è§ˆä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ€æ¡†è®¾è®¡
- **ä¸€è‡´çš„äº¤äº’**: åŒè§†å›¾åˆ‡æ¢ã€ESC å…³é—­ã€èƒŒæ™¯ç‚¹å‡»å…³é—­
- **æ¸…æ™°çš„åŒºåˆ†**: ä¸åŒçš„å›¾æ ‡å’Œæ ‡é¢˜ï¼Œä¸€ç›®äº†ç„¶

### 2. æ— éœ€é¢å¤–æŒ‰é’® (Chunk)

- **ç›´æ¥ç‚¹å‡»**: Chunk å¡ç‰‡æœ¬èº«å°±æ˜¯æŒ‰é’®
- **è§†è§‰åé¦ˆ**: Hover æ•ˆæœæç¤ºå¯ç‚¹å‡»
- **è‡ªç„¶äº¤äº’**: ç¬¦åˆç”¨æˆ·ä¹ æƒ¯ï¼Œå‡å°‘å­¦ä¹ æˆæœ¬

### 3. æ™ºèƒ½çš„æŒ‰é’®æ˜¾ç¤º

- **ä¸Šä¼ æ–‡ä»¶é¢„è§ˆ**: ä¸æ˜¾ç¤ºä¸‹è½½æŒ‰é’®ï¼ˆæ²¡æœ‰æ–‡ä»¶å¯ä¸‹è½½ï¼‰
- **Chunk é¢„è§ˆ**: ä¸æ˜¾ç¤ºä¸‹è½½æŒ‰é’®ï¼ˆä¸æ˜¯å®Œæ•´æ–‡ä»¶ï¼‰
- **ç¿»è¯‘ç»“æœé¢„è§ˆ**: æ˜¾ç¤ºä¸‹è½½æŒ‰é’®ï¼ˆå®Œæ•´ç¿»è¯‘æ–‡ä»¶ï¼‰

### 4. ä¸°å¯Œçš„ä¿¡æ¯å±•ç¤º

**Chunk é¢„è§ˆç‰¹åˆ«æ˜¾ç¤º**:
- ç« èŠ‚åˆ—è¡¨
- æ˜¯å¦åŒ…å« Prologue/Epilogue
- å­—ç¬¦ç»Ÿè®¡

### 5. æ€§èƒ½ä¼˜åŒ–

- **å†…å®¹ç¼“å­˜**: chunk çš„ content åœ¨åˆ†ææ—¶å°±ä¿å­˜å¥½
- **æŒ‰éœ€åŠ è½½**: åªåœ¨ç‚¹å‡»æ—¶æ‰åŠ è½½é¢„è§ˆå†…å®¹
- **å¿«é€Ÿå“åº”**: æœ¬åœ°æ•°æ®ï¼Œæ— éœ€é¢å¤–å¤„ç†

---

## ğŸ¨ è§†è§‰è®¾è®¡

### é¢œè‰²æ–¹æ¡ˆ

| å…ƒç´  | é¢œè‰² | è¯´æ˜ |
|------|------|------|
| ä¸Šä¼ æ–‡ä»¶é¢„è§ˆæŒ‰é’® | ç´«è‰²â†’ç²‰è‰²æ¸å˜ | `from-purple-600 to-pink-500` |
| Chunk é»˜è®¤è¾¹æ¡† | æ·±ç° | `border-slate-600` |
| Chunk Hover è¾¹æ¡† | è“è‰² | `border-blue-500` |
| Chunk èƒŒæ™¯ | åŠé€æ˜ç° | `bg-slate-700/50` |
| æ¨¡æ€æ¡†å›¾æ ‡ | Emoji | ğŸ“„ âœ‚ï¸ âœ… |

### äº¤äº’åŠ¨ç”»

```css
/* Chunk Hover æ•ˆæœ */
.chunk-card {
    transition: all 0.3s ease;
}

.chunk-card:hover {
    border-color: #3b82f6;  /* blue-500 */
    background-color: #334155;  /* slate-700 */
    transform: translateY(-2px);
}
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹ 1: ä¸Šä¼ æ–‡ä»¶é¢„è§ˆ

```bash
âœ… ä¸Šä¼ æ–‡ä»¶åï¼ŒPreview æŒ‰é’®æ˜¾ç¤º
âœ… ç‚¹å‡»æŒ‰é’®æ‰“å¼€é¢„è§ˆæ¨¡æ€æ¡†
âœ… æ ‡é¢˜æ˜¾ç¤º "ğŸ“„ Uploaded File Preview"
âœ… å†…å®¹æ˜¾ç¤ºå®Œæ•´çš„æºæ–‡ä»¶
âœ… Raw Text è§†å›¾æ­£ç¡®æ˜¾ç¤º
âœ… Rendered è§†å›¾æ­£ç¡®æ¸²æŸ“
âœ… ç»Ÿè®¡ä¿¡æ¯å‡†ç¡®
âœ… ä¸‹è½½æŒ‰é’®éšè—
âœ… å…³é—­åŠŸèƒ½æ­£å¸¸
```

### æµ‹è¯•ç”¨ä¾‹ 2: Chunk é¢„è§ˆ

```bash
âœ… åˆ†æåï¼ŒChunk å¡ç‰‡æ˜¾ç¤º
âœ… Hover æ˜¾ç¤ºè“è‰²è¾¹æ¡†
âœ… Cursor å˜ä¸º pointer
âœ… ç‚¹å‡»æ‰“å¼€é¢„è§ˆæ¨¡æ€æ¡†
âœ… æ ‡é¢˜æ˜¾ç¤º "âœ‚ï¸ Chunk {N} Preview"
âœ… å†…å®¹æ˜¾ç¤ºè¯¥ Chunk çš„å®Œæ•´å†…å®¹
âœ… ç« èŠ‚ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
âœ… Prologue/Epilogue æ ‡è®°æ­£ç¡®
âœ… ç»Ÿè®¡ä¿¡æ¯åŒ…å«ç« èŠ‚åˆ—è¡¨
âœ… ä¸‹è½½æŒ‰é’®éšè—
```

### æµ‹è¯•ç”¨ä¾‹ 3: ç¿»è¯‘ç»“æœé¢„è§ˆ

```bash
âœ… ç¿»è¯‘å®Œæˆåï¼ŒPreview æŒ‰é’®æ˜¾ç¤º
âœ… ç‚¹å‡»æŒ‰é’®æ‰“å¼€é¢„è§ˆæ¨¡æ€æ¡†
âœ… æ ‡é¢˜æ˜¾ç¤º "âœ… Translation Preview"
âœ… å†…å®¹æ˜¾ç¤ºç¿»è¯‘ç»“æœ
âœ… ç»Ÿè®¡ä¿¡æ¯å‡†ç¡®
âœ… ä¸‹è½½æŒ‰é’®æ˜¾ç¤º
âœ… ä¸‹è½½åŠŸèƒ½æ­£å¸¸
```

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

### ä¹‹å‰ vs ç°åœ¨

| åŠŸèƒ½ | ä¹‹å‰ | ç°åœ¨ |
|------|------|------|
| **ä¸Šä¼ æ–‡ä»¶æŸ¥çœ‹** | âŒ å¿…é¡»ç”¨ç¼–è¾‘å™¨æ‰“å¼€ | âœ… æµè§ˆå™¨å†…å³æ—¶é¢„è§ˆ |
| **Chunk å†…å®¹æŸ¥çœ‹** | âŒ æ— æ³•æŸ¥çœ‹ | âœ… ç‚¹å‡»å³å¯é¢„è§ˆ |
| **ç¿»è¯‘ç»“æœæŸ¥çœ‹** | âŒ åªèƒ½ä¸‹è½½ | âœ… é¢„è§ˆ + ä¸‹è½½ |
| **å¯¹æ¯”åŸæ–‡è¯‘æ–‡** | âŒ éœ€è¦å¤šä¸ªå·¥å…· | âœ… ä¸€ä¸ªç•Œé¢å®Œæˆ |
| **éªŒè¯åˆ†å—ç­–ç•¥** | âŒ æ— æ³•éªŒè¯ | âœ… å®Œå…¨é€æ˜ |

---

## ğŸš€ æœ€ä½³å®è·µ

### 1. å·¥ä½œæµç¨‹å»ºè®®

**æ ‡å‡†ç¿»è¯‘æµç¨‹**:
```
1. ä¸Šä¼ æ–‡ä»¶
2. ğŸ‘ï¸ é¢„è§ˆä¸Šä¼ æ–‡ä»¶ (ç¡®è®¤å†…å®¹)
3. åˆ†æåˆ†å—
4. ğŸ‘ï¸ ç‚¹å‡» Chunk 1 (ç¡®è®¤èµ·å§‹å†…å®¹)
5. ğŸ‘ï¸ ç‚¹å‡»æœ€åä¸€ä¸ª Chunk (ç¡®è®¤ç»“æŸå†…å®¹)
6. å¼€å§‹ç¿»è¯‘
7. ğŸ‘ï¸ é¢„è§ˆç¿»è¯‘ç»“æœ (è´¨é‡æ£€æŸ¥)
8. ä¸‹è½½æ–‡ä»¶
```

### 2. è´¨é‡æ§åˆ¶

- **Pre-flight æ£€æŸ¥**: ä¸Šä¼ åç«‹å³é¢„è§ˆï¼Œç¡®ä¿æ–‡ä»¶æ­£ç¡®
- **åˆ†å—éªŒè¯**: æ£€æŸ¥å…³é”® Chunkï¼ˆç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼‰
- **ç¿»è¯‘æ ¡å¯¹**: ä½¿ç”¨åŒè§†å›¾å¯¹æ¯” Markdown è¯­æ³•

### 3. è°ƒè¯•æŠ€å·§

- **Chunk å¤ªå¤§**: ç‚¹å‡»é¢„è§ˆæŸ¥çœ‹å®é™…å†…å®¹
- **åˆ†å—ä¸åˆç†**: æŸ¥çœ‹è¾¹ç•Œ Chunk çš„å…·ä½“å†…å®¹
- **æ ¼å¼é—®é¢˜**: åœ¨ Raw Text è§†å›¾ä¸­æ£€æŸ¥è¯­æ³•

---

## ğŸ“ åŸ¹è®­è¦ç‚¹

### å‘ç”¨æˆ·ä»‹ç»æ—¶å¼ºè°ƒ

1. **ä¸‰åˆä¸€é¢„è§ˆ**: ä¸€ä¸ªåŠŸèƒ½ï¼Œä¸‰ç§ç”¨é€”
2. **æ— éœ€ä¸‹è½½**: å…¨ç¨‹æµè§ˆå™¨å†…å®Œæˆ
3. **ç‚¹å‡»å³é¢„è§ˆ**: Chunk ç‰¹åˆ«ç®€å•ï¼Œç›´æ¥ç‚¹å‡»
4. **åŒè§†å›¾æ¨¡å¼**: Raw å’Œ Rendered éšæ—¶åˆ‡æ¢
5. **æ™ºèƒ½æŒ‰é’®**: åªåœ¨éœ€è¦æ—¶æ˜¾ç¤ºä¸‹è½½

### æ¼”ç¤ºè„šæœ¬

```
"ç°åœ¨æˆ‘ä»¬æœ‰ä¸‰ç§é¢„è§ˆåŠŸèƒ½ï¼š

1. ã€ä¸Šä¼ æ–‡ä»¶é¢„è§ˆã€‘- ä¸Šä¼ åï¼Œç‚¹å‡»è¿™ä¸ªç´«è‰²æŒ‰é’®ï¼Œ
   ç«‹å³æŸ¥çœ‹åŸå§‹æ–‡ä»¶ï¼Œç¡®ä¿ä¸Šä¼ æ­£ç¡®ã€‚

2. ã€Chunk é¢„è§ˆã€‘- åˆ†æåï¼Œç›´æ¥ç‚¹å‡»ä»»ä½•ä¸€ä¸ª Chunkï¼Œ
   å°±èƒ½çœ‹åˆ°å®ƒåŒ…å«å“ªäº›å†…å®¹ã€‚ä½ çœ‹ï¼Œé¼ æ ‡æ‚¬åœæ—¶
   è¾¹æ¡†ä¼šå˜è“ï¼Œæç¤ºå¯ä»¥ç‚¹å‡»ã€‚

3. ã€ç¿»è¯‘ç»“æœé¢„è§ˆã€‘- ç¿»è¯‘å®Œæˆåï¼Œç‚¹å‡»è¿™ä¸ªè“è‰²æŒ‰é’®ï¼Œ
   æŸ¥çœ‹ç¿»è¯‘ç»“æœï¼Œæ»¡æ„åå†ä¸‹è½½ã€‚

æ‰€æœ‰é¢„è§ˆéƒ½ä½¿ç”¨åŒä¸€ä¸ªçª—å£ï¼Œæ“ä½œå®Œå…¨ä¸€è‡´ã€‚"
```

---

## ğŸ“ API å‚è€ƒ

### GET /api/preview-source/<task_id>

**æè¿°**: é¢„è§ˆä¸Šä¼ çš„æºæ–‡ä»¶

**è¯·æ±‚**:
```
GET /api/preview-source/abc123
```

**å“åº”**:
```json
{
  "success": true,
  "content": "# Chapter 1\n\nThis is the content...",
  "filename": "book.md",
  "language": "English (source)"
}
```

**é”™è¯¯å“åº”**:
```json
{
  "error": "ä»»åŠ¡ä¸å­˜åœ¨"
}
```

---

### GET /api/preview-chunk/<task_id>/<chunk_id>

**æè¿°**: é¢„è§ˆç‰¹å®š Chunk çš„å†…å®¹

**è¯·æ±‚**:
```
GET /api/preview-chunk/abc123/2
```

**å“åº”**:
```json
{
  "success": true,
  "content": "# Chapter 3\n\nChunk content...",
  "chunk_id": 2,
  "chapters": ["Chapter 3", "Chapter 4"],
  "size": 12500,
  "has_prologue": false,
  "has_epilogue": false
}
```

**é”™è¯¯å“åº”**:
```json
{
  "error": "Chunk ä¿¡æ¯ä¸å¯ç”¨ï¼Œè¯·å…ˆåˆ†ææ–‡ä»¶"
}
```

---

## ğŸ‰ æ€»ç»“

### æ ¸å¿ƒä»·å€¼

1. **å®Œå…¨é€æ˜** - ç”¨æˆ·å¯ä»¥æŸ¥çœ‹å·¥ä½œæµç¨‹çš„æ¯ä¸ªé˜¶æ®µ
2. **è´¨é‡ä¿è¯** - åœ¨æ¯ä¸ªç¯èŠ‚éƒ½èƒ½é¢„è§ˆå’ŒéªŒè¯
3. **æé«˜æ•ˆç‡** - æ— éœ€ä¸‹è½½æ–‡ä»¶ï¼Œæµè§ˆå™¨å†…å®Œæˆæ‰€æœ‰æ£€æŸ¥
4. **å¢å¼ºä¿¡ä»»** - ç”¨æˆ·æ¸…æ¥šçŸ¥é“ç³»ç»Ÿåœ¨åšä»€ä¹ˆ

### æŠ€æœ¯äº®ç‚¹

- âœ… **é›¶å­¦ä¹ æˆæœ¬** - Chunk ç›´æ¥ç‚¹å‡»ï¼Œç¬¦åˆç›´è§‰
- âœ… **ç»Ÿä¸€äº¤äº’** - ä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œä¸‰ç§ç”¨é€”
- âœ… **æ€§èƒ½ä¼˜å¼‚** - å†…å®¹å·²ç¼“å­˜ï¼ŒåŠ è½½è¿…é€Ÿ
- âœ… **è®¾è®¡ä¸€è‡´** - ä¸ç°æœ‰åŠŸèƒ½å®Œç¾èåˆ

### ä¸‹ä¸€æ­¥

è¿™ä¸ªåŠŸèƒ½ä¸ºæœªæ¥çš„å¢å¼ºæ‰“ä¸‹äº†åŸºç¡€ï¼š
- æºæ–‡ä»¶ç¼–è¾‘åŠŸèƒ½
- Chunk åˆå¹¶/æ‹†åˆ†
- å®æ—¶å¯¹æ¯”è§†å›¾
- æ‰¹æ³¨å’Œè¯„è®ºåŠŸèƒ½

---

**ğŸ“š ç›¸å…³æ–‡æ¡£**:
- [é¢„è§ˆåŠŸèƒ½ä½¿ç”¨æŒ‡å—](PREVIEW_FEATURE_GUIDE.md)
- [é¢„è§ˆåŠŸèƒ½å®æ–½æŠ¥å‘Š](PREVIEW_IMPLEMENTATION_REPORT.md)
- [é¢„è§ˆåŠŸèƒ½æ¼”ç¤ºæŒ‡å—](PREVIEW_DEMO_GUIDE.md)

**ğŸŠ æ–°åŠŸèƒ½å·²å®Œæˆï¼Œç«‹å³ä½“éªŒï¼**
